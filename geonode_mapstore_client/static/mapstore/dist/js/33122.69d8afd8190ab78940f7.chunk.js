(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[33122],{833122:(o,e,t)=>{"use strict";t.r(e),t.d(e,{default:()=>S});var r=t(74864),n=t(65792),i=t.n(n),l=t(984596),a=t.n(l),c=t(396026),u=t.n(c);function s(o){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},s(o)}function f(o,e){if(!(o instanceof e))throw new TypeError("Cannot call a class as a function")}function d(o,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(o,(void 0,n=function(o,e){if("object"!==s(o)||null===o)return o;var t=o[Symbol.toPrimitive];if(void 0!==t){var r=t.call(o,"string");if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(r.key),"symbol"===s(n)?n:String(n)),r)}var n}function y(o,e){(null==e||e>o.length)&&(e=o.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=o[t];return r}function p(o){var e,t,n=o.color,l=o.opacity,a=(e=i()(n).gl(),t=4,function(o){if(Array.isArray(o))return o}(e)||function(o,e){var t=null==o?null:"undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(null!=t){var r,n,i,l,a=[],c=!0,u=!1;try{if(i=(t=t.call(o)).next,0===e){if(Object(t)!==t)return;c=!1}else for(;!(c=(r=i.call(t)).done)&&(a.push(r.value),a.length!==e);c=!0);}catch(o){u=!0,n=o}finally{try{if(!c&&null!=t.return&&(l=t.return(),Object(l)!==l))return}finally{if(u)throw n}}return a}}(e,t)||function(o,e){if(o){if("string"==typeof o)return y(o,e);var t=Object.prototype.toString.call(o).slice(8,-1);return"Object"===t&&o.constructor&&(t=o.constructor.name),"Map"===t||"Set"===t?Array.from(o):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?y(o,e):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=a[0],u=a[1],s=a[2],f=a[3];return void 0!==l?new r.Color(c,u,s,l):new r.Color(c,u,s,f)}function h(o,e){var t,r;switch(o){case"polyline":return null===(t=e[o])||void 0===t?void 0:t.positions;case"polygon":return null===(r=e[o])||void 0===r?void 0:r.hierarchy;default:return null}}function m(o){var e=o.color,t=o.opacity,n=o.dasharray;if((null==n?void 0:n.length)<=0)return p({color:e,opacity:t});var i=n.reduce((function(o,e){return o+e}),0);return new r.PolylineDashMaterialProperty({color:p({color:e,opacity:t}),dashLength:i,dashPattern:parseInt(n.map((function(o){return Math.floor(o/i*16)})).map((function(o,e){return u()(o).map((function(){return e%2==0?"1":"0"})).join("")})).join(""),2)})}function v(o){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return o.properties?Object.keys(o.properties).reduce((function(e,t){var r,n=new RegExp("\\{\\{".concat(t,"\\}\\}"),"g");return e.replace(n,null!==(r=o.properties[t])&&void 0!==r?r:"")}),e):e}var g=["billboard","box","corridor","cylinder","ellipse","ellipsoid","label","model","tileset","path","plane","point","polygon","polyline","polylineVolume","rectangle","wall"];function b(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=o.rules,t=void 0===e?[]:e,n=arguments.length>1?arguments[1]:void 0,i=n.images,l=void 0===i?[]:i,c=n.getImageIdFromSymbolizer,u=n.geoStylerStyleFilter,s=void 0===u?function(){return!0}:u;return function(o){var e=o.entities,n=o.opacity,i=void 0===n?1:n;e.forEach((function(o){var e={};g.forEach((function(t){o._msStoredCoordinates||(e[t]=h(t,o)||void 0),o[t]=void 0})),o._msStoredCoordinates||(o._msStoredCoordinates=e)})),t.forEach((function(o){o.symbolizers.forEach((function(t){e.forEach((function(e){var n,u=(null==e||null===(n=e.properties)||void 0===n?void 0:n.getValue(r.JulianDate.now()))||{};if(!o.filter||s({properties:u||{}},o.filter)){if("Mark"===t.kind&&e.position){var f=l.find((function(o){return o.id===c(t)}))||{},d=f.image,y=f.width,h=f.height;if(d){var g=y>h?y:h,b=2*t.radius/g;e.billboard=new r.BillboardGraphics({image:d,scale:b,rotation:r.Math.toRadians(-1*t.rotate||0),disableDepthTestDistance:t.msBringToFront?Number.POSITIVE_INFINITY:0,heightReference:r.HeightReference.CLAMP_TO_GROUND,color:p({color:"#ffffff",opacity:1*i})})}}if("Icon"===t.kind&&e.position){var S=l.find((function(o){return o.id===c(t)}))||{},w=S.image,I=S.width,C=S.height;if(w){var T=I>C?I:C,_=t.size/T;e.billboard=new r.BillboardGraphics({image:w,scale:_,rotation:r.Math.toRadians(-1*t.rotate||0),disableDepthTestDistance:t.msBringToFront?Number.POSITIVE_INFINITY:0,heightReference:r.HeightReference.CLAMP_TO_GROUND,color:p({color:"#ffffff",opacity:t.opacity*i})})}}var O,P,F,j;"Line"===t.kind&&e._msStoredCoordinates.polyline&&(e.polyline=new r.PolylineGraphics({material:null!=t&&t.dasharray?m({color:t.color,opacity:t.opacity*i,dasharray:t.dasharray}):p({color:t.color,opacity:t.opacity*i}),width:t.width,positions:e._msStoredCoordinates.polyline,clampToGround:t.msClampToGround})),"Fill"===t.kind&&e._msStoredCoordinates.polygon&&(e.polygon=new r.PolygonGraphics({material:p({color:t.color,opacity:t.fillOpacity*i}),hierarchy:e._msStoredCoordinates.polygon,classificationType:"terrain"===t.msClassificationType?r.ClassificationType.TERRAIN:"3d"===t.msClassificationType?r.ClassificationType.CESIUM_3D_TILE:r.ClassificationType.BOTH}),t.outlineColor&&0!==t.outlineWidth&&(e.polyline=new r.PolylineGraphics({material:p({color:t.outlineColor,opacity:t.outlineOpacity*i}),width:t.outlineWidth,positions:e._msStoredCoordinates.polygon.getValue().positions,clampToGround:t.msClampToGround}))),"Text"===t.kind&&e.position&&(e.label=new r.LabelGraphics({text:v({properties:u},t.label),font:[t.fontStyle,t.fontWeight,"".concat(t.size,"px"),a()(t.font||["serif"]).join(", ")].filter((function(o){return o})).join(" "),fillColor:p({color:t.color,opacity:1*i}),heightReference:r.HeightReference.CLAMP_TO_GROUND,pixelOffset:new r.Cartesian2(null!==(O=null==t||null===(P=t.offset)||void 0===P?void 0:P[0])&&void 0!==O?O:0,null!==(F=null==t||null===(j=t.offset)||void 0===j?void 0:j[1])&&void 0!==F?F:0),outlineColor:p({color:t.haloColor,opacity:1*i}),outlineWidth:t.haloWidth}))}}))}))}))}}const S=function(){function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.drawIcons,r=e.getImageIdFromSymbolizer,n=e.geoStylerStyleFilter;f(this,o),this._drawIcons=t||function(){return Promise.resolve(null)},this._getImageIdFromSymbolizer=r||function(o){return o.symbolizerId},this._geoStylerStyleFilter=n||function(){return!0}}var e,t;return e=o,t=[{key:"readStyle",value:function(){return new Promise((function(o,e){try{o(null)}catch(o){e(o)}}))}},{key:"writeStyle",value:function(o){var e=this;return new Promise((function(t,r){try{e._drawIcons(o).then((function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=b(o,{images:r,getImageIdFromSymbolizer:e._getImageIdFromSymbolizer,geoStylerStyleFilter:e._geoStylerStyleFilter});t(n)}))}catch(o){r(o)}}))}}],t&&d(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}()}}]);